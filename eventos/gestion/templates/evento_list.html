{% extends 'base.html' %}
{% block title %}Próximos eventos{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h3 mb-0">Próximos eventos</h1>
  {% if user.is_authenticated and perms.gestion.add_evento %}
    <a href="{% url 'evento_create' %}" class="btn btn-primary">+ Crear evento</a>
  {% endif %}
</div>

{% if eventos %}
  <div class="list-group">
    {% for e in eventos %}
      <div class="list-group-item d-flex justify-content-between">
        <div>
          <h5 class="mb-1"><a href="{% url 'evento_detail' pk=e.pk %}" class="text-decoration-none">{{ e.nombre }}</a></h5>
          <div class="text-muted small">
             {{ e.fecha|date:"d/m/Y H:i" }} &nbsp; • &nbsp;  {{ e.ubicacion|default:"Sin ubicación" }} &nbsp; • &nbsp; {{ e.organizador.username }}
          </div>
        </div>
        <div class="ms-3">
          {% if user.is_authenticated and perms.gestion.change_evento %}
            {% if user.is_staff or user.is_superuser or e.organizador_id == user.id %}
              <a class="btn btn-sm btn-outline-secondary" href="{% url 'evento_update' pk=e.pk %}">Editar</a>
            {% endif %}
          {% endif %}
          {% if user.is_authenticated and perms.gestion.delete_evento %}
            {% if user.is_staff or user.is_superuser or e.organizador_id == user.id %}
              <a class="btn btn-sm btn-outline-danger" href="{% url 'evento_delete' pk=e.pk %}">Eliminar</a>
            {% endif %}
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="alert alert-secondary">No hay eventos programados.</div>
{% endif %}
{% endblock %}